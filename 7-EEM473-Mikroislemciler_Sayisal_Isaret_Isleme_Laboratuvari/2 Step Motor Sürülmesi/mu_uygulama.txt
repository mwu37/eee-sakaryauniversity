#include <aduc841.h>
ENA 	EQU 	P0.4
ENB 	EQU 	P0.5
IN1 	EQU 	P0.3
IN2 	EQU 	P0.2
IN3 	EQU 	P0.1
IN4 	EQU 	P0.0
BT5 	EQU 	P3.3
TUR 	EQU 	OOH
ADIM 	EQU 	01H
	ORG 	00H
	SJMP 	BASLA
	ORG 	03H
	SJMP 	EXT_0
BASLA:
	MOV 	R0,#7FH
ZERO:
	MOV 	@R0,#00H
	DJNZ 	R0,ZERO
	MOV 	P0,#00H
	
	MOV 	TMOD,#81H
	MOV 	DPTR,#10225D
	MOV 	TL0,DPL
	MOV 	TH0,DPH
	SETB 	EA
	SETB 	EX0
	
X1:	JB 		BT5,X1
X2: JNB 	BT5,X2
	MOV 	A,TUR
	JZ 		X1
	MOV 	ADIM,#50H
	SETB 	TR0
	
DEVAM:
	SETB 	ENA
	CLR 	ENB
	SETB 	IN1
	CLR 	IN2
	ACALL 	BEKLE
	SETB 	ENB
	CLR 	ENA
	SETB 	IN3
	CLR 	IN4
	ACALL 	BEKLE
	SETB 	ENA
	CLR 	ENB
	SETB 	IN2
	CLR 	IN1
	ACALL 	BEKLE
	SETB 	ENB
	CLR 	ENA
	SETB 	IN4
	CLR 	IN3
	ACALL 	BEKLE
	DJNZ 	ADIM,DEVAM
	
	MOV 	ADIM,#50H
	DJNZ 	TUR,DEVAM
	MOV 	P0,#00H
	SJMP 	X1

BEKLE:
	JNB 	TF0,BEKLE
	CLR 	TF0
	MOV 	TL0,DPL
	MOV 	TH0,DPH
	RET
	
EXT_0:
	ACALL 	BEKLE
	MOV 	TUR,#3
	RETI
	
GECIKME:
	MOV 	R4,#10D
	MOV 	R5,#0FFH
	MOV 	R6,#0FFH
X:	DJNZ 	R5,X
	MOV 	R5,#0FFH
	DJNZ 	R6,X
	MOV 	R6,#0FFH
	DJNZ 	R4,X
	RET
	
	END
		