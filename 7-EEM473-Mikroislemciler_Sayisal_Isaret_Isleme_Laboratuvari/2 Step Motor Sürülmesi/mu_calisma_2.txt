#include 	"aduc841.h"
LED3 	EQU 	P0.2
BTN4 	EQU 	P3.2
BTN5 	EQU 	P3.3
	ORG 	00H
	SJMP 	BASLA
	ORG 	03H
	SJMP 	HARICI
BASLA:
	CLR 	P2.3
	CLR 	LED3
	
	MOV 	R0,#07FH
TMZ:MOV 	@R0,#00H
	DJNZ 	R0,TMZ
	
	SETB 	IT0
	SETB 	EX0
	SETB 	EA
	MOV 	TMOD,#01H ;TIMER0 16 BIT

DONGU:
	MOV 	R0,#169D ;1SN
	SETB 	EA
	JB 		BTN5,$
D:	JNB 	BTN5,$
	JZ 		D
	MOV 	R1,A
	MOV 	A,#00H
	CLR 	EA
X:	SETB 	LED3
	ACALL 	BEKLE
	CLR 	LED3
	ACALL 	BEKLE
	DJNZ 	R1,X
	MOV 	R1,#00H
	SJMP 	DONGU
	
BEKLE:
	MOV 	R0,#169D
	SETB 	TR0
Y:	JNB 	TF0,$
	CLR 	TF0
	MOV 	TL0,#00H
	MOV 	TH0,#00H
	DJNZ 	R0,Y
	CLR 	TR0
	RET
	
HARICI:
	ACALL 	GECIKME ;BTN5 ARK
	JNB 	BTN4,$
	INC 	A
	RETI
	
GECIKME:
	SETB 	PSW.3 ;BANK 1
	MOV 	R4,#10D
	MOV 	R5,#0FFH
	MOV 	R6,#0FFH
W:	
	DJNZ 	R5,W
	MOV 	R5,#0FFH
	DJNZ 	R6,W
	MOV 	R6,#0FFH
	DJNZ 	R4,W
	RET
	
	END
	
